# LR 1 "ИИС" **Капкин Е.В А-01м-23**

## **Описание проекта:**
Цель данного проекта — создание модели для прогнозирования цен на подержанные автомобили с использованием реальных данных. Проект анализирует различные факторы, влияющие на цену продажи, такие как тип топлива, пробег, возраст автомобиля и тип трансмиссии. Для выполнения задачи используется набор данных [Car Price Prediction](https://www.kaggle.com/datasets/vijayaadithyanvg/car-price-predictionused-cars/data), предоставляющий информацию о характеристиках и ценах на автомобили. Модель поможет определить основные факторы, влияющие на стоимость подержанных автомобилей и спрогнозировать их цену.

## **Исследование данных:**
Результаты анализа находятся в `./eda/eda.ipynb`. Основные выводы:
- Значительное влияние на цену оказывает тип топлива, особенно для бензиновых и дизельных автомобилей.
- Пробег автомобиля является важным фактором при определении его текущей стоимости.
- Автомобили с автоматической коробкой передач чаще всего имеют более высокую цену продажи.
- Цена продажи также зависит от возраста автомобиля, с заметным снижением для более старых машин.
- Значения текущей цены (Present_Price) распределены в широком диапазоне, что говорит о разнообразии предлагаемых автомобилей.

# MLFlow Project for Car Price Prediction

## Описание проекта

Проект посвящён прогнозированию цен на автомобили с использованием моделей машинного обучения. В ходе исследования проводились эксперименты с различными моделями и их параметрами. Оптимальные результаты достигнуты с помощью `RandomForestRegressor` и автоматического подбора гиперпараметров с использованием библиотеки `Optuna`.

## **Запуск:**
git clone https://github.com/gorg20121/LR1_IIS/   клонирование репозитория

cd LR1_IIS   переход в папку проекта

python -m venv my_venv   создание виртуального окружения

source my_venv/bin/activate   активация окружения (или ..venv\Scripts\activate для Windows)

pip install -r requirements.txt   установка зависимостей


## Запуск MLFlow

Для запуска MLFlow Tracking Server используйте следующую команду:

mlflow ui --backend-store-uri sqlite:///mlflow.db --host 127.0.0.1 --port 5001

MLFlow UI будет доступен по адресу: http://127.0.0.1:5001

Результаты исследования

Лучшая модель

Лучшая модель, основанная на Random Forest, показала следующие результаты:
	mae: 23.9282
    mape: 1.5977
    mse: 776.2754

Гиперпараметры лучшей модели

	•	n_estimators: 150
	•	max_depth: 15
	•	max_features: 0.8

Выбранные признаки

После применения SequentialFeatureSelector были отобраны следующие признаки:
	•	Present_Price
	•	Driven_kms
	•	Year
	•	Полиномиальные признаки для Present_Price и Driven_kms

Run ID лучшего эксперимента

	•	Run ID: 40ac79177965496cacf03df011d21d9d

Модель была зарегистрирована как версия v2 в MLFlow Model Registry с именем car_modelrf.

Файлы проекта

	•	model_training.py: Основной скрипт для обучения и логирования модели.
	•	requirements.txt: Зависимости для проекта.
	•	.gitignore: Игнорируемые файлы и директории.
	•	README.md: Описание проекта, инструкции по установке и запуску.

Использование

	1.	Запустите MLFlow Tracking Server.
	2.	Запустите скрипт model_training.py для обучения модели и логирования результатов.
	3.	Анализируйте результаты через MLFlow UI.
